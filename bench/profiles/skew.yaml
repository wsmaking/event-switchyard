# Skewed Traffic Profile
# Purpose: Simulate hot-key scenario with uneven key distribution

name: skew
description: "Skewed key distribution to test hot-key handling (70% on single key)"

# Total benchmark duration
duration_sec: 60

# Total events to send
events_total: 10000

# Warmup configuration
warmup:
  percent: 5
  min_events: 100

# Traffic pattern (steady rate throughout)
pattern:
  - phase: steady
    description: "Constant rate with skewed key distribution"
    duration_sec: 60
    rate: 200  # events/sec (moderate, constant rate)

# Key distribution (heavily skewed to BTC)
keys:
  - BTC   # Hot key
  - ETH
  - XRP
  - SOL
  - ADA

keys_distribution:
  type: weighted
  weights:
    BTC: 70   # 70% of traffic goes to BTC (hot key scenario)
    ETH: 15
    XRP: 10
    SOL: 3
    ADA: 2

# Payload configuration
payload:
  size_bytes: 200
  schema:
    type: trade_event
    fields:
      - name: price
        type: double
        range: [1000, 100000]
      - name: quantity
        type: double
        range: [0.1, 100]
      - name: timestamp
        type: long
        value: current_time_ms

# Expected SLO targets for this profile
# Note: Skewed distribution may cause slightly higher tail latency
slo_targets:
  fast_path_p99_us: 150    # Slightly relaxed due to hot-key contention
  fast_path_p999_us: 3000
  tail_ratio_max: 15.0     # Allow higher tail ratio for hot-key scenario
  drop_count: 0
  error_rate_percent: 0.01

# Reporting configuration
reporting:
  window_sec: [5, 30]
  percentiles: [50, 95, 99, 99.9]
  include_jvm_metrics: true

  # Additional skew-specific metrics
  per_key_metrics: true    # Report metrics broken down by key
  hot_key_detection: true  # Flag if key concentration exceeds threshold
